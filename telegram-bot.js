const TelegramBot = require('node-telegram-bot-api');
require('dotenv').config();

// –°–æ–∑–¥–∞–µ–º –±–æ—Ç
const bot = new TelegramBot(process.env.TELEGRAM_BOT_TOKEN || '7572098457:AAFPD0pRhovfJsSzFTnaW1SXpgofR6eZSIk', {
    polling: true
});

console.log('ü§ñ PayDaily Hunt Bot –∑–∞–ø—É—â–µ–Ω!');
console.log('–¢–æ–∫–µ–Ω:', process.env.TELEGRAM_BOT_TOKEN ? '–ó–∞–≥—Ä—É–∂–µ–Ω –∏–∑ .env' : '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é');

// –ö–æ–º–∞–Ω–¥–∞ /start
bot.onText(/\/start/, (msg) => {
    const chatId = msg.chat.id;
    const firstName = msg.from.first_name;
    
    const welcomeMessage = `üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ PayDaily Hunt, ${firstName}!

üí∞ –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É –≤—ã–ø–æ–ª–Ω—è—è –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞–Ω–∏—è!

üöÄ –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:`;

    // –°–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–Ω–æ–ø–∫–æ–π WebApp
    const options = {
        reply_markup: {
            inline_keyboard: [
                [{
                    text: 'üöÄ –û—Ç–∫—Ä—ã—Ç—å PayDaily Hunt',
                    web_app: {
                        url: 'http://192.168.1.102:3000' // –õ–æ–∫–∞–ª—å–Ω—ã–π IP –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                    }
                }],
                [{
                    text: 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
                    callback_data: 'stats'
                }, {
                    text: '‚ùì –ü–æ–º–æ—â—å',
                    callback_data: 'help'
                }]
            ]
        }
    };

    bot.sendMessage(chatId, welcomeMessage, options);
});

// –ö–æ–º–∞–Ω–¥–∞ /help
bot.onText(/\/help/, (msg) => {
    const chatId = msg.chat.id;
    
    const helpMessage = `‚ùì –ü–æ–º–æ—â—å - PayDaily Hunt

üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1Ô∏è‚É£ –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–û—Ç–∫—Ä—ã—Ç—å PayDaily Hunt"
2Ô∏è‚É£ –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞
3Ô∏è‚É£ –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ
4Ô∏è‚É£ –ü–æ–ª—É—á–∏—Ç–µ –Ω–∞–≥—Ä–∞–¥—É –≤ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–µ

üíé –î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è:
‚Ä¢ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤–∏–¥–µ–æ –Ω–∞ YouTube
‚Ä¢ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ Telegram –∫–∞–Ω–∞–ª—ã
‚Ä¢ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
‚Ä¢ –£—á–∞—Å—Ç–∏–µ –≤ –æ–ø—Ä–æ—Å–∞—Ö
‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!

üí∞ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤:
‚Ä¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: 1000 —Ç–æ—á–µ–∫ (1 USDT)
‚Ä¢ –ö–æ–º–∏—Å—Å–∏—è: 5%
‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–µ—Ç–∏: BSC, Polygon

üÜò –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å? –ù–∞–ø–∏—à–∏—Ç–µ @support`;

    bot.sendMessage(chatId, helpMessage);
});

// –ö–æ–º–∞–Ω–¥–∞ /stats
bot.onText(/\/stats/, (msg) => {
    const chatId = msg.chat.id;
    
    const statsMessage = `üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ PayDaily Hunt

üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 1,234
üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞–Ω–∏–π: 5,678
üí∞ –í—ã–ø–ª–∞—á–µ–Ω–æ: $12,345
‚≠ê –°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥: 4.8/5

üî• –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è:
1. –ü—Ä–æ—Å–º–æ—Ç—Ä –≤–∏–¥–µ–æ - 45%
2. –ü–æ–¥–ø–∏—Å–∫–∏ - 30%
3. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è - 15%
4. –û–ø—Ä–æ—Å—ã - 10%

üìà –†–æ—Å—Ç –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π: +23%`;

    bot.sendMessage(chatId, statsMessage);
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ callback –∑–∞–ø—Ä–æ—Å–æ–≤
bot.on('callback_query', (callbackQuery) => {
    const message = callbackQuery.message;
    const data = callbackQuery.data;
    const chatId = message.chat.id;

    // –£–±–∏—Ä–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    bot.answerCallbackQuery(callbackQuery.id);

    switch (data) {
        case 'stats':
            bot.sendMessage(chatId, `üìä –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

üí∞ –ë–∞–ª–∞–Ω—Å: 1,250 —Ç–æ—á–µ–∫
üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞–Ω–∏–π: 45
üìà –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –≤—Å–µ–≥–æ: $15.50
üèÜ VIP —Å—Ç–∞—Ç—É—Å: –ë—Ä–æ–Ω–∑–æ–≤—ã–π
üî• –î–Ω–µ–≤–Ω–∞—è —Å–µ—Ä–∏—è: 7 –¥–Ω–µ–π

üöÄ –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∑–∞–¥–∞–Ω–∏–π!`);
            break;
            
        case 'help':
            bot.sendMessage(chatId, `‚ùì –ë—ã—Å—Ç—Ä–∞—è –ø–æ–º–æ—â—å:

üÜò –ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–¥–∞–Ω–∏—è–º–∏? –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
üí∞ –ù–µ –ø—Ä–∏—à–ª–∞ –Ω–∞–≥—Ä–∞–¥–∞? –ü–æ–¥–æ–∂–¥–∏—Ç–µ –¥–æ 5 –º–∏–Ω—É—Ç
üö´ –ó–∞–¥–∞–Ω–∏–µ –Ω–µ –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è? –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —É—Å–ª–æ–≤–∏–π
üí≥ –ü—Ä–æ–±–ª–µ–º—ã —Å –≤—ã–≤–æ–¥–æ–º? –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∞–¥—Ä–µ—Å–∞ –∫–æ—à–µ–ª—å–∫–∞

üìû –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞: @paydaily_support
üí¨ –ß–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: @paydaily_chat`);
            break;
    }
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
bot.on('error', (error) => {
    console.error('–û—à–∏–±–∫–∞ –±–æ—Ç–∞:', error);
});

bot.on('polling_error', (error) => {
    console.error('–û—à–∏–±–∫–∞ polling:', error);
});

// Graceful shutdown
process.on('SIGINT', () => {
    console.log('\nüõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞...');
    bot.stopPolling();
    process.exit(0);
});

console.log('‚úÖ –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /start –≤ Telegram');
console.log('üîó –°—Å—ã–ª–∫–∞ –Ω–∞ –±–æ—Ç–∞: https://t.me/YourBotUsername');
console.log('üì± WebApp URL: http://192.168.1.102:3000');
console.log('\nüí° –î–ª—è production –∑–∞–º–µ–Ω–∏—Ç–µ localhost –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω!'); 