# Реферальная система PayDaily Hunt

## Обзор

Реферальная система позволяет пользователям приглашать друзей и зарабатывать дополнительные баллы и деньги. Система полностью интегрирована в приложение и доступна через страницу профиля и отдельную страницу рефералов.

## Функциональность

### Для пользователей (рефереров)

1. **Получение реферального кода** - уникальный код для каждого пользователя
2. **Реферальная ссылка** - готовая ссылка для приглашения друзей
3. **Статистика рефералов** - количество приглашенных пользователей
4. **Заработок с рефералов** - 10% от всех заработков рефералов
5. **Бонусы за приглашение** - 100 баллов за каждого приглашенного пользователя

### Для приглашенных пользователей

1. **Приветственный бонус** - 100 баллов при регистрации
2. **Автоматическая привязка** - к рефереру через реферальный код

## Техническая реализация

### Backend

#### Модель User (backend/models/User.js)

```javascript
// Реферальная система
referralCode: {
    type: String,
    unique: true
},
referredBy: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'User',
    default: null
},
referralEarnings: {
    type: Number,
    default: 0
},
referrals: [{
    user: {
        type: mongoose.Schema.Types.ObjectId,
        ref: 'User'
    },
    totalEarned: {
        type: Number,
        default: 0
    },
    tasksCompleted: {
        type: Number,
        default: 0
    },
    joinedAt: {
        type: Date,
        default: Date.now
    }
}]
```

#### API Endpoints

- `GET /api/users/profile` - получение профиля с реферальной информацией
- `GET /api/users/referrals` - получение списка рефералов и статистики

### Frontend

#### Страницы

1. **ProfilePage** (`frontend/src/pages/ProfilePage.js`)
   - Таб "Профиль" с основной информацией о реферальной программе
   - Таб "Рефералы" со списком приглашенных пользователей

2. **ReferralsPage** (`frontend/src/pages/ReferralsPage.js`)
   - Таб "Обзор" с общей статистикой и объяснением системы
   - Таб "Мои рефералы" со списком рефералов
   - Таб "Поделиться" с инструментами для привлечения рефералов

#### Компоненты

- **Статистика рефералов** - карточки с ключевыми метриками
- **Список рефералов** - отображение приглашенных пользователей
- **Инструменты для шаринга** - кнопки для Telegram, WhatsApp, копирование
- **Советы по привлечению** - рекомендации для увеличения рефералов

## Использование

### Для пользователей

1. **Переход в профиль**
   - Нажмите на иконку профиля в навигации
   - Перейдите на таб "Рефералы"

2. **Просмотр статистики**
   - Общее количество рефералов
   - Заработанные деньги с рефералов
   - Количество активных рефералов

3. **Поделиться ссылкой**
   - Скопируйте реферальный код или ссылку
   - Используйте кнопки для шаринга в социальных сетях
   - Отправьте друзьям через мессенджеры

4. **Отслеживание рефералов**
   - Просматривайте список приглашенных пользователей
   - Отслеживайте их активность и заработки

### Для разработчиков

#### Добавление новых функций

1. **Новые типы бонусов**
   ```javascript
   // В backend/routes/auth.js
   const referralBonus = 100; // Измените значение
   ```

2. **Изменение процента комиссии**
   ```javascript
   // В backend/routes/tasks.js
   const commission = (completion.reward * 10) / 100; // Измените процент
   ```

3. **Добавление новых метрик**
   ```javascript
   // В backend/routes/users.js
   const referralStats = {
       totalReferrals: referrals.length,
       totalEarnings: user.referralEarnings,
       activeReferrals: referrals.filter(r => r.tasksCompleted > 0).length,
       // Добавьте новые метрики здесь
   };
   ```

#### Стилизация

Все стили находятся в соответствующих CSS файлах:
- `frontend/src/pages/ProfilePage.css`
- `frontend/src/pages/ReferralsPage.css`

## Конфигурация

### Переменные окружения

```env
# Backend
FRONTEND_URL=https://your-domain.com
REFERRAL_BONUS_PERCENT=10

# Frontend
REACT_APP_API_URL=http://localhost:5000/api
```

### Настройки реферальной системы

```javascript
// В backend/config/referral.js (создайте файл)
module.exports = {
    bonusPercent: 10, // Процент комиссии с рефералов
    welcomeBonus: 100, // Бонус за приглашение
    minWithdrawal: 1000, // Минимальная сумма для вывода
    maxReferrals: null // Максимальное количество рефералов (null = без ограничений)
};
```

## Безопасность

1. **Валидация реферальных кодов** - проверка уникальности и формата
2. **Защита от мошенничества** - отслеживание подозрительной активности
3. **Ограничения** - предотвращение создания множественных аккаунтов
4. **Аудит** - логирование всех операций с рефералами

## Мониторинг

### Метрики для отслеживания

1. **Конверсия рефералов** - процент зарегистрированных от перешедших по ссылке
2. **Активность рефералов** - количество выполненных заданий
3. **Доходность** - средний заработок с одного реферала
4. **Удержание** - доля активных рефералов через время

### Логирование

```javascript
// В backend/routes/auth.js
console.log(`Новый реферал: ${user.telegramId} приглашен ${referrer.telegramId}`);
```

## Будущие улучшения

1. **Многоуровневая реферальная система** - комиссии с рефералов рефералов
2. **Реферальные уровни** - бонусы за достижение определенного количества рефералов
3. **Геймификация** - достижения и награды за привлечение рефералов
4. **Аналитика** - детальная статистика и графики
5. **Уведомления** - уведомления о новых рефералах и заработках

## Поддержка

При возникновении проблем с реферальной системой:

1. Проверьте логи backend сервера
2. Убедитесь в корректности переменных окружения
3. Проверьте подключение к базе данных
4. Обратитесь к документации API

## Лицензия

Реферальная система является частью проекта PayDaily Hunt и подчиняется тем же условиям лицензии.